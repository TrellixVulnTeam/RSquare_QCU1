<!-- ./home/templates/home/product.html -->
{% extends "base.html" %}
{% load wagtailimages_tags %}

{% block content %}
    <div class="container grid-lg">
        <div class="columns">
            <div class="column col-4">
                {% image product.image max-300x300 as temp_image %}
                <script>console.log(temp_image)</script>
                <img src="{{temp_image.url}}" alt="" />
            </div>
            <div class="column col-8">
                <h1>
                    {{ product.title }}
                </h1>

                <p>
                    {{ product.short_description }}
                </p>

                <p>
                    {% for f in custom_fields %}
                        {% if f.options_array|length > 0 %}
                            <div class="form-group">
                                <label class="form-label" for="{{ f.name|lower }}">
                                    {{ f.name }}
                                </label>
                                <select class="form-select custom-field-select" id="{{ f.name|lower }}" data-field="{{ forloop.counter }}">
                                    {% for opt in f.options_array %}
                                        <option>
                                            {{ opt }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                        {% endif %}
                    {% endfor %}
                </p>
                <script>console.log({{product.id}})</script>
                <a type="submit" class=" btn btn-primary" value="{{product.id}}" href='{% url 'home:passidpesanan' pk=product.id %}'>
                    <i class="icon icon-plus"></i>Add to cart </a>
                </a>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.custom-field-select').onchange = function(event) {
                if (event.target.dataset.field) {
                    document.querySelector('.snipcart-add-item')
                        .dataset['itemCustom' + event.target.dataset.field + 'Value'] = event.target.value;
                }
            };
        },false);
    </script>
{% endblock %}